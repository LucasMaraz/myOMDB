{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React from \"react\";\nimport axios from \"axios\";\nimport { useHistory } from \"react-router-dom\";\nimport Swal from \"sweetalert2\";\nexport const useForm = (validates, key) => {\n  _s();\n\n  const history = useHistory();\n  let objectValues = {};\n  const [values, setValues] = React.useState(objectValues);\n  const [errors, setErrors] = React.useState({});\n  const [isSubmitting, setIsSubmitting] = React.useState(false);\n  React.useEffect(() => {\n    if (Object.keys(errors).length === 0 && isSubmitting) {\n      submitForm();\n    }\n\n    key === \"register\" ? objectValues = {\n      username: \"\",\n      email: \"\",\n      password: \"\",\n      password2: \"\"\n    } : objectValues = {\n      email: \"\",\n      password: \"\"\n    };\n  }, [errors]);\n\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setValues({ ...values,\n      [name]: value\n    });\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    setErrors(validates(values));\n    setIsSubmitting(true);\n  };\n\n  const submitForm = () => {\n    key === \"register\" ? axios.post(\"/api/auth/register\", { ...values\n    }).then(res => res.data).then(Swal.fire({\n      icon: \"success\",\n      title: \"Account created\",\n      showConfirmButton: false,\n      timer: 3000\n    })).then(() => history.push(\"/login\")).catch(() => Swal.fire({\n      title: \"ERROR\",\n      text: \"Username or password incorrect\",\n      icon: \"error\",\n      confirmButtonText: \"Ok\"\n    })) : axios.post(\"/api/auth/login\", { ...values\n    }).then(res => res.data).then(Swal.fire({\n      icon: \"success\",\n      title: \"Successfully logged in\",\n      showConfirmButton: false,\n      timer: 3000\n    })).then(() => history.push(\"/home\")).then(() => window.location.reload()).catch(() => Swal.fire({\n      title: \"ERROR\",\n      text: \"Username or password incorrect\",\n      icon: \"error\",\n      confirmButtonText: \"Ok\"\n    }));\n  };\n\n  return {\n    values,\n    handleSubmit,\n    handleChange,\n    submitForm,\n    errors\n  };\n};\n\n_s(useForm, \"LhcNGdLIIYJKKUCv3R11BjIJYjQ=\", false, function () {\n  return [useHistory];\n});","map":{"version":3,"sources":["/home/lucas/Escritorio/P5/03Bootcamp/OMDB/src/hooks/useForm.jsx"],"names":["React","axios","useHistory","Swal","useForm","validates","key","history","objectValues","values","setValues","useState","errors","setErrors","isSubmitting","setIsSubmitting","useEffect","Object","keys","length","submitForm","username","email","password","password2","handleChange","e","name","value","target","handleSubmit","preventDefault","post","then","res","data","fire","icon","title","showConfirmButton","timer","push","catch","text","confirmButtonText","window","location","reload"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\nimport { useHistory } from \"react-router-dom\";\nimport Swal from \"sweetalert2\";\n\nexport const useForm = (validates, key) => {\n  const history = useHistory();\n\n  let objectValues = {};\n  const [values, setValues] = React.useState(objectValues);\n  const [errors, setErrors] = React.useState({});\n  const [isSubmitting, setIsSubmitting] = React.useState(false);\n\n  React.useEffect(() => {\n    if (Object.keys(errors).length === 0 && isSubmitting) {\n      submitForm();\n    }\n\n    key === \"register\"\n      ? (objectValues = {\n          username: \"\",\n          email: \"\",\n          password: \"\",\n          password2: \"\",\n        })\n      : (objectValues = {\n          email: \"\",\n          password: \"\",\n        });\n  }, [errors]);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setValues({\n      ...values,\n      [name]: value,\n    });\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setErrors(validates(values));\n    setIsSubmitting(true);\n  };\n\n  const submitForm = () => {\n    key === \"register\"\n      ? axios\n          .post(\"/api/auth/register\", {\n            ...values,\n          })\n          .then((res) => res.data)\n          .then(\n            Swal.fire({\n              icon: \"success\",\n              title: \"Account created\",\n              showConfirmButton: false,\n              timer: 3000,\n            })\n          )\n          .then(() => history.push(\"/login\"))\n          .catch(() =>\n            Swal.fire({\n              title: \"ERROR\",\n              text: \"Username or password incorrect\",\n              icon: \"error\",\n              confirmButtonText: \"Ok\",\n            })\n          )\n      : axios\n          .post(\"/api/auth/login\", {\n            ...values,\n          })\n          .then((res) => res.data)\n          .then(\n            Swal.fire({\n              icon: \"success\",\n              title: \"Successfully logged in\",\n              showConfirmButton: false,\n              timer: 3000,\n            })\n          )\n          .then(() => history.push(\"/home\"))\n          .then(() => window.location.reload())\n          .catch(() =>\n            Swal.fire({\n              title: \"ERROR\",\n              text: \"Username or password incorrect\",\n              icon: \"error\",\n              confirmButtonText: \"Ok\",\n            })\n          );\n  };\n\n  return {\n    values,\n    handleSubmit,\n    handleChange,\n    submitForm,\n    errors,\n  };\n};\n"]},"metadata":{},"sourceType":"module"}